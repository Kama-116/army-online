<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background: #1c1c1c; color: white; text-align: center; font-family: 'Arial', sans-serif; margin: 0; overflow: hidden; user-select: none; }
        
        /* ВЕРХНЯЯ ПАНЕЛЬ */
        .top-bar { 
            display: flex; background: rgba(0,0,0,0.9); padding: 8px 5px; 
            font-size: 11px; justify-content: space-around; border-bottom: 2px solid #f1c40f;
            position: relative; z-index: 100;
        }
        .user-info { text-align: left; min-width: 70px; }
        .stat-item { display: flex; flex-direction: column; align-items: center; gap: 2px; }
        .val { color: #f1c40f; font-weight: bold; font-size: 13px; }

        /* ПРАВАЯ ПАНЕЛЬ НАВИГАЦИИ */
        .right-nav {
            position: absolute; right: 10px; top: 70px; display: flex; 
            flex-direction: column; gap: 10px; z-index: 50;
        }
        .nav-btn {
            width: 50px; height: 50px; background: rgba(44, 62, 80, 0.9); 
            border: 2px solid #f1c40f; border-radius: 12px; 
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.5);
        }
        .nav-btn:active { transform: scale(0.9); }

        /* ГЛАВНЫЙ ГЕРОЙ (КАЗАРМА) */
        #main-view { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }
        #char-img { width: 100%; height: 100%; object-fit: cover; }

        /* НИЖНЯЯ ПАНЕЛЬ (СОСЛУЖИВЦЫ) */
        .bottom-panel {
            position: absolute; bottom: 0; width: 100%; height: 110px;
            background: rgba(0,0,0,0.85); display: flex; align-items: center; z-index: 60; border-top: 1px solid #555;
        }
        .friends-list { display: flex; overflow-x: auto; gap: 8px; width: 70%; padding: 0 10px; }
        .friend-slot { min-width: 60px; height: 60px; background: #333; border: 2px solid #f1c40f; border-radius: 8px; overflow: hidden; }
        
        .voenkom-area { width: 30%; text-align: center; padding-right: 5px; }
        .voenkom-btn { 
            background: #c0392b; color: white; border: none; padding: 8px 5px; 
            font-size: 10px; border-radius: 5px; font-weight: bold; cursor: pointer;
        }

        /* ОКНА ЛОКАЦИЙ */
        .window { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(26, 26, 26, 0.98); z-index: 1000; display: none; 
            flex-direction: column; align-items: center; justify-content: center;
        }
        .win-content { width: 90%; }
        .mission-card {
            background: #333; margin: 10px 0; padding: 15px; border-radius: 10px;
            border: 1px solid #f1c40f; display: flex; justify-content: space-between; align-items: center;
        }
        .close-btn { margin-top: 20px; color: #e74c3c; font-weight: bold; padding: 10px; border: 1px solid #e74c3c; border-radius: 5px; }
    </style>
</head>
<body>

    <div class="top-bar">
        <div class="user-info">
            <div id="nickname" onclick="changeNick()" style="color:#f1c40f; font-weight:bold;">Боец</div>
            <div style="font-size:10px;">УРОВЕНЬ: <span id="level">1</span></div>
        </div>
        <div class="stat-item">
            <img src="https://img.icons8.com/color/48/medallion.png" width="20">
            <span class="val" id="score">0</span>
        </div>
        <div class="stat-item">
            <img src="https://img.icons8.com/color/48/lightning-bolt.png" width="20">
            <span class="val" id="energy">100</span>
        </div>
        <div class="stat-item">
            <img src="https://img.icons8.com/color/48/cigarette.png" width="20">
            <span class="val" id="cigs">10</span>
        </div>
        <div class="stat-item">
            <img src="https://img.icons8.com/color/48/ruble.png" width="20">
            <span class="val" id="money">100</span>
        </div>
        <div onclick="toggleMedia()"><img src="https://img.icons8.com/color/48/high-volume.png" width="20"></div>
    </div>

    <div class="right-nav">
        <div class="nav-btn" onclick="showWin('bosses')"><img src="https://img.icons8.com/color/96/military-helmet.png" width="35"></div>
        <div class="nav-btn" onclick="showWin('chipok')"><img src="https://img.icons8.com/color/96/tea-cup.png" width="35"></div>
        <div class="nav-btn" onclick="showWin('album')"><img src="https://img.icons8.com/color/96/photo-album.png" width="35"></div>
        <div class="nav-btn" onclick="showWin('tattoo')"><img src="https://img.icons8.com/color/96/tattoo-machine.png" width="35"></div>
        <div class="nav-btn" onclick="showWin('help')"><img src="https://img.icons8.com/color/96/cardboard-box.png" width="35"></div>
        <div class="nav-btn" onclick="showWin('missions')"><img src="https://img.icons8.com/color/96/map-marker--v1.png" width="35"></div>
        <div class="nav-btn" onclick="showWin('plac')"><img src="https://img.icons8.com/color/96/combat-boots.png" width="35"></div>
        <div class="nav-btn" onclick="closeWins()"><img src="https://img.icons8.com/color/96/barracks.png" width="35"></div>
    </div>

    <div id="main-view">
        <img id="char-img" src="https://raw.githubusercontent.com/Kama-116/army-online/9f579bfe3fe90a46980437c2063d2168b6ac5136/rank1.JPG" alt="Персонаж">
    </div>

    <div class="bottom-panel">
        <div class="friends-list" id="friends">
            <div class="friend-slot"><img src="https://via.placeholder.com/60/333/f1c40f?text=?" width="100%"></div>
            <div class="friend-slot"><img src="https://via.placeholder.com/60/333/f1c40f?text=?" width="100%"></div>
            <div class="friend-slot"><img src="https://via.placeholder.com/60/333/f1c40f?text=?" width="100%"></div>
            <div class="friend-slot"><img src="https://via.placeholder.com/60/333/f1c40f?text=?" width="100%"></div>
        </div>
        <div class="voenkom-area">
            <div style="font-size: 9px; margin-bottom: 5px;">ЗАЛОЖИТЬ КОРЕША</div>
            <button class="voenkom-btn" onclick="inviteFriend()">ВОЕНКОМУ</button>
        </div>
    </div>

    <div id="win-missions" class="window">
        <h2>КОМАНДИРОВКИ</h2>
        <div class="win-content">
            <div class="mission-card">
                <span>СВО</span>
                <button onclick="doMission(10, 50)">10 ⚡</button>
            </div>
            <div class="mission-card">
                <span>СИРИЯ</span>
                <button onclick="doMission(20, 120)">20 ⚡</button>
            </div>
            <div class="mission-card">
                <span>АФРИКА</span>
                <button onclick="doMission(30, 200)">30 ⚡</button>
            </div>
        </div>
        <div class="close-btn" onclick="closeWins()">НАЗАД В КАЗАРМУ</div>
    </div>

    <div id="win-chipok" class="window">
        <h2>ЧИПОК</h2>
        <p>Здесь можно купить ништяки за рубли.</p>
        <div class="close-btn" onclick="closeWins()">ВЕРНУТЬСЯ</div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        // Состояние
        let score = parseInt(localStorage.getItem('score')) || 0;
        let money = parseInt(localStorage.getItem('money')) || 100;
        let nick = localStorage.getItem('nick') || "Боец";
        let energy = 100;

        function updateUI() {
            document.getElementById('score').innerText = score;
            document.getElementById('money').innerText = money;
            document.getElementById('nickname').innerText = nick;
            document.getElementById('energy').innerText = energy;
        }

        function showWin(id) {
            closeWins();
            let win = document.getElementById('win-' + id);
            if(win) win.style.display = 'flex';
        }

        function closeWins() {
            document.querySelectorAll('.window').forEach(w => w.style.display = 'none');
        }

        function doMission(cost, reward) {
            if (energy >= cost) {
                energy -= cost;
                score += reward;
                localStorage.setItem('score', score);
                updateUI();
                tg.HapticFeedback.notificationOccurred('success');
                tg.showAlert("Миссия выполнена! Получено " + reward + " авторитета.");
            } else {
                tg.showAlert("Мало энергии! Нужно подождать.");
            }
        }

        function changeNick() {
            if (money >= 100) {
                let n = prompt("Смена позывного (100 руб):");
                if(n) {
                    money -= 100; nick = n;
                    localStorage.setItem('nick', nick);
                    localStorage.setItem('money', money);
                    updateUI();
                }
            } else { tg.showAlert("Мало рублей!"); }
        }

        function inviteFriend() {
            tg.showAlert("Приглашение отправлено! (Здесь будет ваша ссылка)");
        }

        updateUI();
    </script>
</body>
</html>